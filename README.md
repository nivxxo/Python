# –û—Ç—á–µ—Ç –ø–æ –∞–Ω–∞–ª–∏–∑—É –¥–∞–Ω–Ω—ã—Ö –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø–æ–µ–∑–¥–æ–∫
üìã –û –ø—Ä–æ–µ–∫—Ç–µ
–ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø–æ–µ–∑–¥–æ–∫ —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è ML –º–æ–¥–µ–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏.

## üöÄ–≠—Ç–∞–ø—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
### üì• –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–µ—Ä–≤–∏—á–Ω—ã–π –æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö
–ö–æ–¥:

–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–æ–∫

try:
   
    df = pd.read_csv('ncr_ride_bookings.csv')
   
    print("–§–∞–π–ª 'ncr_ride_bookings.csv' –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ!")

except FileNotFoundError:
    
    try:
       
        df = pd.read_csv('–¥–∞—Ç–∞cer_uber_pides_bookings.csv')
        
        print("–§–∞–π–ª '–¥–∞—Ç–∞cer_uber_pides_bookings.csv' –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ!")
   
    except FileNotFoundError:
        
        print("–û–®–ò–ë–ö–ê: –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        
        exit()
–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:

- –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ —Ñ–∞–π–ª–æ–≤
- –ü–µ—Ä–≤–∏—á–Ω—ã–π –æ—Å–º–æ—Ç—Ä - –ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö
- –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞–Ω–Ω—ã—Ö (df.info())
- –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —á–∏—Å–ª–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
- –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤
- –í—ã–≤–æ–¥ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –®–∞–≥–∞ 1:
‚úÖ –§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω

‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

‚úÖ –ü–æ–ª—É—á–µ–Ω–∞ –±–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

‚úÖ –í—ã—è–≤–ª–µ–Ω—ã –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

### üìä –®–∞–≥ 2: –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –æ–±–∑–æ—Ä –¥–∞–Ω–Ω—ã—Ö

–ö–æ–¥ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:

missing_values = df.isnull().sum()

missing_percentage = (df.isnull().sum() / len(df)) * 100

missing_info = pd.DataFrame({
    '–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π': missing_values,
    '–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤': missing_percentage.round(2)
})

–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:
- –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º
- –ê–Ω–∞–ª–∏–∑ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
- –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ (—Å—Ç–∞—Ç—É—Å, —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–∏—Å–ª–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
- –ê–Ω–∞–ª–∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å —Ç–∏–ø–∞–º–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
- –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
- –ü—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –®–∞–≥–∞ 2:

‚úÖ –í—ã—è–≤–ª–µ–Ω—ã –≤—Å–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

‚úÖ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

‚úÖ –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –∫–ª—é—á–µ–≤—ã–µ —Å—Ç–æ–ª–±—Ü—ã

‚úÖ –ü–æ–ª—É—á–µ–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –∏ —Ç–∏–ø–∞–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞

‚úÖ –°–æ–±—Ä–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —á–∏—Å–ª–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º

üîç –®–∞–≥ 3: –í—ã–±–æ—Ä–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
–ö–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤:

booking_id_cols = [col for col in all_columns if 'booking' in col.lower() and 'id' in col.lower()]

datetime_cols = [col for col in all_columns if any(x in col.lower() for x in ['date', 'time', 'datetime'])]

status_cols = [col for col in all_columns if 'status' in col.lower()]

vehicle_cols = [col for col in all_columns if 'vehicle' in col.lower() or 'auto' in col.lower()]

–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:
- –í—ã–±–æ—Ä–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É "Cancelled by Driver"
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ (Auto + Value > 500)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ (–º–∞—Ä—Ç 2024 –≥–æ–¥–∞)

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–π:

‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤

‚úÖ –ù–∞–π–¥–µ–Ω—ã –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å –æ—Ç–º–µ–Ω–æ–π –≤–æ–¥–∏—Ç–µ–ª–µ–º

‚úÖ –í—ã—è–≤–ª–µ–Ω—ã –¥–æ—Ä–æ–≥–∏–µ –ø–æ–µ–∑–¥–∫–∏ –Ω–∞ Auto

‚úÖ –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω—ã –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞ –º–∞—Ä—Ç 2024

‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –æ—Å–Ω–æ–≤–∞ –¥–ª—è feature engineering

### üîß –®–∞–≥ 4: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –ø–æ–¥–±–æ—Ä X-—Ñ–∞–∫—Ç–æ—Ä–æ–≤ –¥–ª—è –º–æ–¥–µ–ª–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
–°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤:

df_enhanced['hour_of_day'] = df_enhanced[datetime_column].dt.hour

df_enhanced['day_of_week'] = df_enhanced[datetime_column].dt.dayofweek

df_enhanced['month'] = df_enhanced[datetime_column].dt.month

df_enhanced['is_weekend'] = (df_enhanced['day_of_week'] >= 5).astype(int)

–í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã –¥–Ω—è

def get_time_of_day(hour):
   
    if 5 <= hour < 12: return 'Morning'
    
    elif 12 <= hour < 17: return 'Afternoon'
    
    elif 17 <= hour < 22: return 'Evening'
    
    else: return 'Late_Night'

df_enhanced['time_of_day'] = df_enhanced['hour_of_day'].apply(get_time_of_day)

–°–æ–∑–¥–∞–Ω–∏–µ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤:

–†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏

def calculate_distance(row):
    
    from math import radians, sin, cos, sqrt, atan2
    
    lat1, lon1 = row['pickup_lat'], row['pickup_lng']
    
    lat2, lon2 = row['dropoff_lat'], row['dropoff_lng']
    
    lat1, lon1, lat2, lon2 = map(radians, [lat1, lon1, lat2, lon2])
    
    dlat = lat2 - lat1
    
    dlon = lon2 - lon1
    
    a = sin(dlat/2)**2 + cos(lat1)*cos(lat2)*sin(dlon/2)**2
    
    c = 2 * atan2(sqrt(a), sqrt(1-a))
    
    return 6371 * c  # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –∫–º

df_enhanced['distance_km'] = df_enhanced.apply(calculate_distance, axis=1)
–§–∞–∫—Ç–æ—Ä—ã —Å–ø—Ä–æ—Å–∞ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è:

–ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –ø—Ä–æ–º–µ–∂—É—Ç–∫–∞–º

hourly_demand = df_enhanced.groupby(['hour_of_day', 'day_of_week']).size()

df_enhanced['demand_factor'] = df_enhanced['historical_hourly_demand'] / df_enhanced['historical_hourly_demand'].max()

–§–∞–∫—Ç–æ—Ä—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞:

vehicle_type_mapping = {'Auto': 1, 'Mini': 1, 'Sedan': 2, 'SUV': 3, 'Luxury': 4}

df_enhanced['vehicle_type_encoded'] = df_enhanced[vehicle_col].map(vehicle_type_mapping)

vehicle_cost_map = {'Auto': 1.0, 'Mini': 1.2, 'Sedan': 1.5, 'SUV': 2.0, 'Luxury': 3.0}

df_enhanced['vehicle_cost_multiplier'] = df_enhanced[vehicle_col].map(vehicle_cost_map)

–í–Ω–µ—à–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã:

–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å

df_enhanced['season'] = df_enhanced['month'].map({
    12: 'Winter', 1: 'Winter', 2: 'Winter', 3: 'Spring', 4: 'Spring', 5: 'Spring',
    6: 'Summer', 7: 'Summer', 8: 'Summer', 9: 'Autumn', 10: 'Autumn', 11: 'Autumn'
})

–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–±–æ–∫

def estimate_traffic(hour, day_of_week):
    
    morning_peak = (7 <= hour <= 10)
    
    evening_peak = (17 <= hour <= 20)
   
    weekend = (day_of_week >= 5)
    
    if weekend: return 'Low'
    
    elif morning_peak or evening_peak: return 'High'
    
    else: return 'Medium'

df_enhanced['traffic_level'] = df_enhanced.apply(lambda row: estimate_traffic(row['hour_of_day'], row['day_of_week']), axis=1)
–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã:

–ê–Ω–∞–ª–∏–∑ –æ—Ç–º–µ–Ω

total_cancellations = (df_enhanced[status_col].str.contains('cancel', case=False, na=False)).sum()

df_enhanced['global_cancellation_rate'] = total_cancellations / len(df_enhanced)

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º/–≤–æ–¥–∏—Ç–µ–ª—è–º

booking_counts = df_enhanced.groupby(id_column).size()

df_enhanced = df_enhanced.merge(booking_counts, on=id_column, how='left')

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –®–∞–≥–∞ 4:

‚úÖ –°–æ–∑–¥–∞–Ω–æ 30+ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

‚úÖ –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã: —á–∞—Å, –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏, –º–µ—Å—è—Ü, –≤—ã—Ö–æ–¥–Ω—ã–µ

‚úÖ –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã: —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, —Ç–∏–ø –ø–æ–µ–∑–¥–∫–∏

‚úÖ –§–∞–∫—Ç–æ—Ä—ã —Å–ø—Ä–æ—Å–∞: –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π —Å–ø—Ä–æ—Å, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏

‚úÖ –§–∞–∫—Ç–æ—Ä—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞: —Ç–∏–ø, —Å—Ç–æ–∏–º–æ—Å—Ç—å, –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å

‚úÖ –í–Ω–µ—à–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã: —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å, –ø—Ä–æ–±–∫–∏, –ø–æ–≥–æ–¥–∞

‚úÖ –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–º–µ–Ω, –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### üìà –®–∞–≥ 5: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
–ö–æ–¥ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ ML –¥–∞—Ç–∞—Å–µ—Ç–∞:

–í—ã–±–æ—Ä —Ñ–∏—á–µ–π –¥–ª—è –º–æ–¥–µ–ª–∏

feature_columns = [
    'hour_of_day', 'day_of_week', 'month', 'is_weekend', 'is_peak_hour',
    'vehicle_type_encoded', 'vehicle_cost_multiplier', 'demand_factor'
]

One-Hot Encoding –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
categorical_columns = ['time_of_day']
df_encoded = pd.get_dummies(df_enhanced, columns=categorical_columns, prefix=categorical_columns)

–°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
ml_dataset = df_encoded[feature_columns + [target_column]].copy()
ml_dataset = ml_dataset.dropna()
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏:

‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è ML —Å–æ–∑–¥–∞–Ω

‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ features: 15+

‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ samples: 10,000+

‚úÖ –£–¥–∞–ª–µ–Ω—ã –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

‚úÖ –î–∞–Ω–Ω—ã–µ –≥–æ—Ç–æ–≤—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π

### ü§ñ –®–∞–≥ 6: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É –º–æ–¥–µ–ª–µ–π

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:

Gradient Boosting –º–æ–¥–µ–ª–∏:

- XGBoost (XGBRegressor)
- LightGBM (LGBMRegressor)
- CatBoost (CatBoostRegressor)

–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ ML –º–æ–¥–µ–ª–∏:
- Random Forest Regressor
- Linear Regression —Å –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–º–∏ —Ñ–∏—á–∞–º–∏
- Support Vector Regression (SVR)

–ù–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏:
- MLP Regressor
- TabNet –¥–ª—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞:

from sklearn.ensemble import RandomForestRegressor

from sklearn.model_selection import train_test_split

from sklearn.metrics import mean_absolute_error, r2_score

X = ml_dataset[numeric_features]

y = ml_dataset[target_column]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

model = RandomForestRegressor(n_estimators=100, random_state=42)

model.fit(X_train, y_train)

y_pred = model.predict(X_test)

print(f"MAE: {mean_absolute_error(y_test, y_pred):.2f}")

print(f"R¬≤: {r2_score(y_test, y_pred):.3f}")

–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ü–µ–Ω–∫–∏:

- MAE (Mean Absolute Error)
- RMSE (Root Mean Square Error)
- R¬≤ (R-squared)
- MAPE (Mean Absolute Percentage Error)
### üìä –®–∞–≥ 7: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –∞–Ω–∞–ª–∏–∑

–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π:

import matplotlib.pyplot as plt

import seaborn as sns

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª—è –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤

plt.style.use('seaborn-v0_8')

fig = plt.figure(figsize=(20, 15))

1. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ–µ–∑–¥–æ–∫:

python

plt.subplot(3, 3, 1)

plt.hist(df_enhanced[value_col].dropna(), bins=30, alpha=0.7, color='skyblue', edgecolor='black')

plt.title('–†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –°–¢–û–ò–ú–û–°–¢–ò –ü–û–ï–ó–î–û–ö', fontweight='bold')

plt.xlabel('–°—Ç–æ–∏–º–æ—Å—Ç—å')

plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–µ–∑–¥–æ–∫')

2. –°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ —Ç–∏–ø–∞–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞:

python

plt.subplot(3, 3, 2)

vehicle_price = df_enhanced.groupby(vehicle_col)[value_col].mean().sort_values(ascending=False)

vehicle_price.plot(kind='bar', color=['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7'])

plt.title('–°–†–ï–î–ù–Ø–Ø –°–¢–û–ò–ú–û–°–¢–¨ –ü–û –¢–ò–ü–ê–ú –¢–†–ê–ù–°–ü–û–†–¢–ê', fontweight='bold')

3. –°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ —á–∞—Å–∞–º –¥–Ω—è:

python

plt.subplot(3, 3, 3)

hourly_price = df_enhanced.groupby('hour_of_day')[value_col].mean()

plt.plot(hourly_price.index, hourly_price.values, marker='o', linewidth=2, color='#FF6B6B')

plt.title('–°–¢–û–ò–ú–û–°–¢–¨ –ü–û –ß–ê–°–ê–ú –î–ù–Ø', fontweight='bold')

4. –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏:

python

plt.subplot(3, 3, 4)

day_names = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å']

day_counts = df_enhanced['day_of_week'].value_counts().sort_index()

plt.bar(day_names, day_counts, color=['#4ECDC4'] * 5 + ['#FF6B6B'] * 2)

plt.title('–ë–†–û–ù–ò–†–û–í–ê–ù–ò–Ø –ü–û –î–ù–Ø–ú –ù–ï–î–ï–õ–ò', fontweight='bold')

5. –ê–Ω–∞–ª–∏–∑ –ø–∏–∫–æ–≤—ã—Ö —á–∞—Å–æ–≤:

python

plt.subplot(3, 3, 5)

peak_counts = df_enhanced['is_peak_hour'].value_counts()

plt.pie(peak_counts, labels=['–ù–µ –ø–∏–∫–æ–≤—ã–µ', '–ü–∏–∫–æ–≤—ã–µ'], autopct='%1.1f%%', startangle=90)

plt.title('–ü–ò–ö–û–í–´–ï –ß–ê–°–´', fontweight='bold')

6. –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –ø–æ–µ–∑–¥–æ–∫:

python

plt.subplot(3, 3, 6)

season_counts = df_enhanced['season'].value_counts()

season_order = ['Winter', 'Spring', 'Summer', 'Autumn']

season_counts = season_counts.reindex(season_order)

plt.bar(season_counts.index, season_counts.values)

plt.title('–°–ï–ó–û–ù–ù–û–°–¢–¨ –ü–û–ï–ó–î–û–ö', fontweight='bold')

7. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π:


plt.subplot(3, 3, 7)

plt.hist(df_enhanced['distance_km'].dropna(), bins=30, alpha=0.7, color='#4ECDC4', edgecolor='black')

plt.title('–†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –†–ê–°–°–¢–û–Ø–ù–ò–ô', fontweight='bold')

plt.xlabel('–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ (–∫–º)')

8. –°–ø—Ä–æ—Å –ø–æ —á–∞—Å–∞–º:


plt.subplot(3, 3, 8)

hourly_demand = df_enhanced.groupby('hour_of_day')['historical_hourly_demand'].mean()

plt.plot(hourly_demand.index, hourly_demand.values, marker='s', linewidth=2, color='#45B7D1')

plt.title('–°–†–ï–î–ù–ò–ô –°–ü–†–û–° –ü–û –ß–ê–°–ê–ú', fontweight='bold')

9. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å–æ —Å—Ç–æ–∏–º–æ—Å—Ç—å—é:


plt.subplot(3, 3, 9)

correlation = ml_dataset[numeric_features + [value_col]].corr()[value_col].abs().sort_values(ascending=False)

top_features = correlation[1:9].index

corr_data = ml_dataset[top_features.tolist() + [value_col]].corr()[value_col].drop(value_col)

plt.barh(range(len(corr_data)), corr_data.values)

plt.yticks(range(len(corr_data)), corr_data.index)

plt.title('–ö–û–†–†–ï–õ–Ø–¶–ò–Ø –ü–†–ò–ó–ù–ê–ö–û–í –°–û –°–¢–û–ò–ú–û–°–¢–¨–Æ', fontweight='bold')

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:

Heatmap –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π:

fig, ax = plt.subplots(figsize=(12, 10))

correlation_matrix = ml_dataset[numeric_features + [value_col]].corr()

sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', center=0, square=True)

plt.title('–ú–ê–¢–†–ò–¶–ê –ö–û–†–†–ï–õ–Ø–¶–ò–ô –ü–†–ò–ó–ù–ê–ö–û–í', fontweight='bold')

Boxplot –ø–æ —Ç–∏–ø–∞–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞:

fig, ax = plt.subplots(figsize=(12, 6))

top_vehicles = df_enhanced[vehicle_col].value_counts().head(5).index

plot_data = df_enhanced[df_enhanced[vehicle_col].isin(top_vehicles)]

sns.boxplot(data=plot_data, x=vehicle_col, y=value_col)

plt.title('–†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –°–¢–û–ò–ú–û–°–¢–ò –ü–û –¢–ò–ü–ê–ú –¢–†–ê–ù–°–ü–û–†–¢–ê', fontweight='bold')

### üìã –®–∞–≥ 8: –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è—Ö

‚úÖ –°–æ–∑–¥–∞–Ω—ã —É–º–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (features) –¥–ª—è ML –º–æ–¥–µ–ª–∏

‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ–µ–∑–¥–æ–∫

‚úÖ –°–æ–∑–¥–∞–Ω—ã –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- –ò—Å—Ö–æ–¥–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤: 15
- –°–æ–∑–¥–∞–Ω–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤: 45
- –ù–æ–≤—ã—Ö features –¥–æ–±–∞–≤–ª–µ–Ω–æ: 30
- –ì–æ—Ç–æ–≤–æ –¥–ª—è ML: 10,000+ –∑–∞–ø–∏—Å–µ–π
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤: 15+
-  –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è: 'booking_value'

–°–æ–∑–¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:

‚è∞ –í–†–ï–ú–ï–ù–ù–´–ï:

hour_of_day, day_of_week, month

is_weekend, time_of_day, is_peak_hour

üó∫Ô∏è –ì–ï–û–ì–†–ê–§–ò–ß–ï–°–ö–ò–ï:

distance_km, is_short_trip, is_long_trip

üìà –°–ü–†–û–° –ò –¶–ï–ù–´:

historical_hourly_demand, demand_factor

hourly_cancellation_rate, global_cancellation_rate

üöó –¢–†–ê–ù–°–ü–û–†–¢:

vehicle_type_encoded, vehicle_cost_multiplier

vehicle_overall_popularity, is_popular_vehicle

üå¶Ô∏è –í–ù–ï–®–ù–ò–ï –§–ê–ö–¢–û–†–´:

season, is_holiday, estimated_weather

traffic_level, weather_encoded, traffic_encoded

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:

‚Ä¢ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: 50.00

‚Ä¢ –°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: 345.67

‚Ä¢ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: 1250.00

‚Ä¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: 198.45
